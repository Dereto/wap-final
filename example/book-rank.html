<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title><!DOCTYPE html>
        <html lang="en">
        <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Ranking</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f2f2f2;
        }

        .error-message {
            color: red;
        }
    </style>
</head>
<body>

<div class="main">
    <h1>Ranking</h1>
    <table id="rankingTable">
        <thead>
        <tr>
            <th>Rank</th>
            <th>Book ID</th>
            <th>Title</th>
            <th>Read Count</th>
        </tr>
        </thead>
        <tbody id="rankingBody">
        <!-- Ranking data will be displayed here -->
        </tbody>
    </table>
    <p id="errorMessage" class="error-message"></p>
    <a href="home.html" class="back-button">Back to Home</a>
</div>

<script>
    // Function to fetch ranking data from the backend
    function fetchRanking() {
        fetch('http://localhost:8080/api/book/read-count/', {
            method: 'GET'
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch ranking');
                }
                return response.json();
            })
            .then(data => {
                data.sort((a, b) => b.read_count - a.read_count);

                var rankingBody = document.getElementById('rankingBody');
                rankingBody.innerHTML = '';

                data.forEach((entry, index) => {
                    var row = rankingBody.insertRow();
                    var rankCell = row.insertCell(0);
                    var bookIdCell = row.insertCell(1);
                    var titleCell = row.insertCell(2);
                    var readCountCell = row.insertCell(3);

                    rankCell.textContent = index + 1;
                    bookIdCell.textContent = entry.book_id;
                    titleCell.textContent = entry.title;
                    readCountCell.textContent = entry.read_count;
                });
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('errorMessage').textContent = 'Failed to fetch ranking. Please try again later.';
            });
    }

    // Call fetchRanking function when the page loads
    document.addEventListener('DOMContentLoaded', fetchRanking);
</script>

</body>
</html>
</title>
</head>
<body>

</body>
</html>